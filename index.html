<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>HTML CALCULATOR | MINOR PROJECT 2</title>
        <link href="vendor/bootstrap-5.3.2-dist/css/bootstrap.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <style>
            .calc-btn{
                width: 70px;
                height: 70px;
            }
            .calc-display{
                background-color: black;
                color: white;
                height: 100px;
                width: 300px;
                border-radius: 15px;
            }
            .inputString{
                margin-top: 5px;
                height: 20px;
                display: block;
                font-size: 20px;
            }
            .expressionString{
                margin-top: 5px;
                height: 20px;
                display: block;
                font-size: 20px;
            }
            .valueString{
                margin-top: 5px;
                height: 20px;
                display: block;
                font-size: 20px;
            }
        </style>
    </head>
    <body>
        <div class="container p-5">
            <div class="d-flex justify-content-center">
                <div class="col-sm-12 col-md-4 col-lg-4">
                    <div class="card">
                        <div class="d-flex justify-content-center align-items-center p-2">
                            <div class="row">
                                <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 calc-display">
                                    <div id="number_div" class="inputString">0</div>
                                    <div id="expression" class="expressionString"></div>
                                    <div id="value_div" class="valueString"></div>
                                </div>
                                <input type="hidden" id="savedExpression">
                            </div>
                        </div>
                        <div class="d-flex justify-content-center align-items-center p-2">
                            <div class="row">
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="Delete">AC</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="Delete">DEL</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="%">%</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="/">/</button>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-center align-items-center p-2">
                            <div class="row">
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="7">7</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="8">8</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="9">9</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="*">x</button>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-center align-items-center p-2">
                            <div class="row">
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="4">4</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="5">5</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="6">6</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="-">-</button>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-center align-items-center p-2">
                            <div class="row">
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="1">1</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="2">2</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="3">3</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="+">+</button>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-center align-items-center p-2">
                            <div class="row">
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="0">0</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="00">00</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key=".">.</button>
                                </div>
                                <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                                    <button type="button" class="btn btn-light calc-btn" data-event_key="=">=</button>
                                </div>
                            </div>
                        </div>
                     </div>
                </div>
            </div>
        </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="vendor/bootstrap-5.3.2-dist/js/bootstrap.js"></script>
        <script>
            $(document).on('keypress',function(e){
                $('button[data-event_key="'+e.key+'"]').addClass('active')
                if((e.keyCode >=48 && e.keyCode <=57) || (e.keyCode >=96 && e.keyCode <= 105)){
                    appendNumber(e.key)
                }else{
                    if(e.key=='+' || e.key=='-' || e.key=='*' || e.key=='/' || e.key=='%'){
                        genExpress(e.key)
                    }else if(key =='='){
                        calExpression()
                    }else if(key =='Delete'){
                        clearCalc()
                    }
                }
                console.log(e.key);
            })

            $(document).on('keyup',function(e){
                $('button[data-event_key="'+e.key+'"]').removeClass('active')
                console.log(e.key);
            })

            $('.calc-btn').on('click',function(e){
                var key = $(this).data('event_key')
                if(key!= '+' && key!= '-' && key!= '.' && key!= '=' && key!= '*' && key!= '/' && key!= '%' && key!= 'Delete'){
                    appendNumber(key)
                }else{
                    if(key=='+' || key=='-' || key=='*' || key=='/' || key=='%'){
                        genExpress(key)
                    }else if(key =='='){
                        calExpression()
                    }else if(key =='Delete'){
                        clearCalc()
                    }
                    
                }    
                console.log(key)
            })

            function appendNumber(number){
                var exNumber = $("#number_div").html();
                console.log(exNumber);
                var currString = number;
                var outputString = '';
                if(exNumber != '' && exNumber != undefined && exNumber != null){
                    if(exNumber==0){
                        outputString=number
                    }else{
                        outputString = exNumber+=currString
                    }
                
                }else{
                    outputString = currString;

                }$("#number_div").html(outputString);
            }

            function genExpress(operator){
                var exNumber = $("#number_div").html();
                var currOperator = operator;
                var expression = '';
                var savedExpression = $("#savedExpression").val();
                if(savedExpression== '' || savedExpression==undefined || savedExpression==null){
                    expression = parseInt(exNumber) + operator
                }else{
                    expression = savedExpression + exNumber + operator;
                }
                $("#number_div").html("")
                $("#savedExpression").val(expression)
                $("#expression").html(expression)
            }

            function calExpression(){
                var result = '';
                var expression = $("#savedExpression").val();
                var exNumber = $("#number_div").html();
                if(exNumber != '' || exNumber != undefined || exNumber != null){
                    expression = expression + parseInt(exNumber);
                }
                result = eval(expression)
                $("#savedExpression").val("")
                $("#number_div").html(result)
                $("#value_div").html(result)
            }

            function clearCalc(){
                $("#number_div").html("")
                $("#savedExpression").val("")
                $("#expression").html("")
                $("#value_div").html("")
            }
        </script>
    </body>
</html>